services:
  backend:
    image: kalukwo/juja-foods-api:latest
    container_name: jujafoods-backend
    ports:
      - "5000:8080" 
    environment:
      - ConnectionStrings__DefaultConnection=Host=34.41.232.227;Database=JujaFoodsDb;Username=postgres;Password=KejaHUnT@2217;Port=5432;
      - ASPNETCORE_ENVIRONMENT=Production
    depends_on:
      - migrations-backend
    restart: unless-stopped

  migrations-backend:
    image: kalukwo/juja-foods-api:migrations
    container_name: jujafoods-migrations
    environment:
      - ConnectionStrings__DefaultConnection=Host=34.41.232.227;Database=JujaFoodsDb;Username=postgres;Password=KejaHUnT@2217;Port=5432;
    restart: "no"